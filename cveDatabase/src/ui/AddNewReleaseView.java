package ui;

import java.awt.Dimension;
import java.awt.Font;
import java.awt.Window;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowEvent;

import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;

import services.ServiceLayer;

public class AddNewReleaseView extends JPanel implements ActionListener {
	private ServiceLayer services = new ServiceLayer();
	Font font = new Font("Arial", Font.PLAIN, 20);
	private JButton insert;
	private JLabel lbl= new JLabel("new release name");
	private JTextField txtAdd;
	public boolean isGEnerated = false;
	public String branchName=null;

	public AddNewReleaseView() {

		inital();
	}
	private void inital(){

		lbl.setFont(font);
		add(lbl);
		//-------------------------
		txtAdd=new  JTextField();
		txtAdd.setFont(font);
		txtAdd.setPreferredSize(new Dimension(200, 35));
		add(txtAdd);
		//--------------------
		insert=new JButton("Add");
		insert.setFont(font);
		insert.addActionListener(this);;
		add(insert);
		
		
	}
	@Override
	public void actionPerformed(ActionEvent e) {
		System.out.println(e.getSource());
		UIManager.put("OptionPane.messageFont", font);
		UIManager.put("OptionPane.buttonFont", font);
		if(e.getSource()==insert){
			if(txtAdd.getText().isEmpty()){
				JOptionPane.showMessageDialog(this, "Please Enter the relase name", "Error",
						JOptionPane.ERROR_MESSAGE);
				return;
			}

			String result=services.addNewRelase(txtAdd.getText().toString());
			if(result.equals("OK")){
				JOptionPane.showMessageDialog(this, "The new release has been generated", "OK",
						JOptionPane.INFORMATION_MESSAGE);
				insert.setEnabled(false);
				isGEnerated=true;
				branchName=txtAdd.getText().toString();
				closeWindoe();
				
			}else if(result!=null && !result.equals("OK")){
				JOptionPane.showMessageDialog(this, "Dublicated release name", "Warning",
						JOptionPane.WARNING_MESSAGE);
			}else
				JOptionPane.showMessageDialog(this, "Connection Fail", "Error",
						JOptionPane.ERROR_MESSAGE);
			closeWindoe();
			
		}
		
	}
	private void closeWindoe() {
		Window win = SwingUtilities.getWindowAncestor(this);
		if (win != null) {
			win.dispose();
		}

	}

}
