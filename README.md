# CVE Management Tool

CVE Management Tool is a Java-based desktop application and it provides a facility to add, edit and delete CVE information for an end user. This application accepts an input file from [CVE Check Tool](https://github.com/otcshare/isafw/tree/master/integration/yocto/recipes) (Github) and saves the CVE information in a MySQL database.
## 1- Requirement
to use this application you have to install pre requirement library and tools.
* [JDK 1.8](https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html) (Java Development Kit) or [JRE 1.8](https://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html) (Java Runtime Environment)
* [MySQl Workbench 6.3](https://dev.mysql.com/downloads/workbench/) (If you need help about how to install and config Mysql database please look at this [link](https://www.youtube.com/watch?v=WuBcTJnIuzo))

## 2- Creating a Database Table 
I hope you could install JDK and MySQL successfully. 
Now it is a time to create all tables and to insert some important information in the bales. Please follow the construction step by step. I have to mention that `you are not allowed` to change schema name, table name, column name or data type. you `are allowed` to change a just specific table that I will inform you later.
### 2.1- Create Schema
Our Database schema name is `cve_data`.
```
CREATE SCHEMA `cve_data` ;
```
### 2.2- Create Tables
In this step, you have to create `7` tables. Please run all provided script one by one 
#### 2.2.1 - CVE Table
This table records CVE information like id, Score, description... 

````
CREATE TABLE `cve_data`.`cve_tb` (
  `cve_id` VARCHAR(20) NOT NULL,
  `score` DOUBLE NULL,
  `description` MEDIUMTEXT NULL,
  `affected_version` MEDIUMTEXT NULL,
  `more_information` TEXT NULL,
  `vector` TEXT NULL,
  PRIMARY KEY (`cve_id`));
````
#### 2.2.2 - Create Package Table
The Package talbe records package name.
```
CREATE TABLE `cve_data`.`package_tb` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `package_name` TEXT NULL,
  PRIMARY KEY (`id`));
```
#### 2.2.3 - Create a relation table between cve tble and package table.
```
CREATE TABLE `cve_data`.`cve_package` (
  `cve_id` VARCHAR(20) NOT NULL,
  `package_id` INT(11) NOT NULL,
  PRIMARY KEY (`cve_id`, `package_id`));
```
#### 2.2.4 - Create Master Table
This table records CVE value for master branch. 
```
CREATE TABLE `cve_data`.`master_tb` (
  `cve_id` VARCHAR(20) NOT NULL,
  `status` TEXT NULL,
  `latest_edit` DATETIME NULL,
  PRIMARY KEY (`cve_id`));
```
#### 2.2.5 - Create a Specific Table for a Release
This table records CVE values for a specific release. You can choose any name 
for this table which is match with you release name in the company by following a very simple roll. 
````
'Name' + '_tb' = Name_tb
````
In this example, I have chosen `el4` and as you see in the script I wrote `el4_tb`. You can modify the below script with your desired name. Do not forget the name because we will need in the `step 8`.
```
CREATE TABLE `cve_data`.`el4_tb` (
  `cve_id` VARCHAR(20) NOT NULL,
  `package_id` INT(11) NOT NULL,
  `latest_edit` DATETIME NULL,
  `status` TEXT NULL,
  `edited` TINYINT(4) NULL,
  PRIMARY KEY (`cve_id`, `package_id`));
```
#### 2.2.6 - Create a Release Table
This table records just release name.
````
CREATE TABLE `cve_data`.`release_tb` (
  `release_name` VARCHAR(20) NOT NULL,
  `created_date` DATETIME NULL,
  PRIMARY KEY (`release_name`));
````
#### 2.2.7 - Create a User Table
There is two user access mode in this application. 
* User mode. The user mode is suitable for a user who wants to just check a value or export data.
* Admin mode. A user is allowed to access all parts of the application.

The User Table records the user mode and admin mode password.
````
CREATE TABLE `cve_data`.`user_tb` (
  `user_name` VARCHAR(50) NOT NULL,
  `password` TEXT NOT NULL,
  PRIMARY KEY (`user_name`));
````
#### 2.2.8 - Insert pre-required data
Before using the application you have to insert your specific release table name which you have chosen in the `step 5` in release table and also you need to insert the user and admin mode password in the user table.

````
Insert into cve_data.release_tb (release_name,created_date) values("el4",now());
````
````
insert into cve_data.user_tb (user_tb.user_name,user_tb.password) value("admin","CVEadmin"),("user","user");
````
## 3- How to Use CVE Management Tool Application
There are two way to run the application:
* Run the application by using exexutable file which is in the Executable Fil folder. please downlod all the files inside a folder and run cve-301.jar file.
* Clone the source code in your eclipse and run as a java application. 

### 3.1- Login Page
When you run the application you will get a login page.

![login](https://user-images.githubusercontent.com/26363869/46798213-9cb5b800-cd51-11e8-87c0-106fce97744e.png)
In this page, you can log in in Admin or User mode. Type your password (If you forget your password please look at 2.8- Insert pre-required data section) and press enters to log in the application.
### 3.2- Database Setting Page
IF you have not configured your database address, the Setting page will be opened automatically to configure you database address, username, and password. 

![database setting](https://user-images.githubusercontent.com/26363869/46800002-a68dea00-cd56-11e8-82a0-d9f302bc8c0d.png)

When you fill in your MySQL database address, port, database username and password, press the _**Test Connection**_ button to test the connection. If you get the successful message on the screen, please press the _**Save**_ button to save your connection information.

### 3.3 - Import Data into The Application
When you are running the application for the first time, a list on the main page should be empty at the moment. Then It is a time to import data in the application. To import data click `File -> Import` or use `Alt-key+I`.

![import](https://user-images.githubusercontent.com/26363869/46802857-e6f16600-cd5e-11e8-8b8f-14dae7464231.png)

I have to mention about import file format. The file format must be `exactly` the same as sample format and there is an `empty line` between each CVE object

````
PACKAGE NAME: apt
PACKAGE VERSION: 1.2.24
CVE: CVE-2016-1252
CVE STATUS: Unpatched
CVE SUMMARY: The apt package in Debian jessie before 1.0.9.8.4
CVSS v2 BASE SCORE: 4.3
VECTOR: NETWORK
MORE INFORMATION: https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-1252

PACKAGE NAME: apt-native
PACKAGE VERSION: 1.2.24
CVE: CVE-2016-1252
CVE STATUS: Unpatched
CVE SUMMARY: The apt package in Debian jessie before 1.0.9.8.4
CVSS v2 BASE SCORE: 4.3
VECTOR: NETWORK
MORE INFORMATION: https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-1252
````
You can choose your release to import file in it. Then press the _**Open**_ button and select your file from your computer. The application will Automatically read al the CVE information from the file and insert them into the database as you see in the picture.
### 3.4 - Main Page
After importing your data, The main list has been filled and it looks like below.

![main page](https://user-images.githubusercontent.com/26363869/46945463-2082e380-d075-11e8-8b8c-1a77bc33187e.png)

There are different information and activity on the list.
* Each row of the list has been colored based on the score property.
* You can change the sorting of the list by double click on the name of the column and by default is sorted on the Score property.
* You can search your CVE in the search place.
* Press **`+`** button to add manually a new CVE information. (More information in 3.5)
* You can edit a row by double click in the row. (More information in 3.5)

### 3.5 - Edit a row or Add a new CVE manually 
When you double click on a row or click on the **`+`** The Eidt row or Add new page will be opened. Both pages are the same.

![edit row](https://user-images.githubusercontent.com/26363869/46946623-9fc5e680-d078-11e8-840c-cf9d687a9695.png)

There are three actions on this page:
* 1- **`Save`** : Click **`Save`** button to save your information.
* 2- **`Delete`** : Click **`Delete`** button to delete the CVE.
* 3- **`X`** : Click **`X`** to close the window without doing anything.

I should mention that Th product value is an auto-completion filed. You can search your desired value by typing in the box. If you could not succeed to find the value, click on **`+`** button to add in the list.
### 3.6 - Add a New Release Name
Click on **`File -> New Release`** or use hotkey **`ALT+N`** to open The New Release page. 
you can write your release name and click on the **`ADD`** button to create the new release. 
### 3.6 Export Page
This page provides a facility to create an output file. There are 7 steps to create the file.


![export page 2](https://user-images.githubusercontent.com/26363869/46960072-ee39ac00-d09d-11e8-9630-5540fd27ef06.png)

#### 3.6.1 Select Output Columns
The select part is a very important part. because you will decide which columns be in the output file. All columns are selected by default and you can unselect **`All`** check box to select your desired columns.
#### 3.6.2 Condition Section
In the condition section, you can make different condition and filter the output result. All these conditions are disabled by default and you can enable each one by clicking on the checkbox and giving a value.
#### 3.6.3 Generate Preview of The Result
You will see a preview of your select and condition result in the result windows. you can change the selection and condition part until you are satisfied with the previewed result.
#### 3.6.4 Add Columns Name
After generating preview result, it is time to modify previewed result by adding column names and using different separation value. In step 4, you can select to have a column name before value and choose a one of  **`;`** , **`:`** , **`=`** , **` White Space`** , **`,`** and **`New Line`** separation sign between column name and value.

#### 3.6.5 Add Separation Sign
Step 5, It is time to choose a one of  **`;`** , **`:`** , **`=`** , **` White Space`** , **`,`** and **`New Line`** separation sign between the CVE properties.

#### 3.6.6 Generate a New Preview Result
you will see a new preview result by Affecting selection, condition, column name, and separation sign parts.

#### 3.6.7
The final step is serving your result in the file by clicking on **`Save to file `** button. The output file format is **`Text`** file.
## 4- Future works
In the next version of this application you will see:
* 1 - improve the Edit page
* 2 - add more output file formats like **` PDF`**, **` XML`** and **` JSON`**

## 5- Licence
This application is opensource and free to use.
